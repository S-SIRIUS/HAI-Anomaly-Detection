# HAI-Anomaly-Detection
## 모델링
stackedgru(all) + conv1d LSTM(f9, f11)
### 1) 베이스 모델(stackedgru): 
StackedGRU (Gated Recurrent Unit) 모델을 활용하여 시계열 데이터의 예측 성능을 향상시켰습니다. 모델의 학습 과정에서 window size, batch size, 그리고 threshold를 조정하는 방식으로 실험을 진행했습니다. 이러한 매개변수들을 조정함으로써 모델이 데이터의 패턴을 더 정확히 파악하고 예측 성능을 극대화할 수 있도록 했습니다.

성능 향상의 또 다른 요소로는 후처리 기법인 버터워스 필터링(Butterworth smoothing)을 적용했습니다. 버터워스 필터는 시그널 프로세싱 분야에서 널리 사용되는 기법으로, 높은 수준의 평활화(smoothing)를 제공함으로써 예측 결과의 잡음을 줄이고, 결과의 안정성을 높이는 데 기여했습니다. 이러한 접근 방식은 모델의 전반적인 예측 정확도를 개선하는 데 중요한 역할을 했습니다.

### 2) 추가모델(conv1d LSTM)
LSTM(Long Short-Term Memory) 모델을 상관관계 분석결과에 활용하였습니다.

* 상관관계가 변형된 Column

| Group 1     | Group 2                           | Group 3                          | Group 4                          | Group 5                                      | Group 6           | Group 7       | Group 8                        | Group 9                 |
|-------------|-----------------------------------|----------------------------------|----------------------------------|----------------------------------------------|-------------------|---------------|-------------------------------|-------------------------|
| P1_B3004    | P1_B3005                          | P1_B4002                         | P1_B3005                         | P1_B3005                                     | P1_PCV02D         | P1_PIT01      | P1_TIT01                      | P2_VXT02                |
| P1_LIT01    | P1_FCV03D                         | P1_B4022                         | P1_FCV03D                        | P1_FT01                                      | P1_PCV02Z         | P4_ST_PT01    | P4_ST_TT01                    | P2_VXT03                |
|             | P1_FCV03Z                         | P1_TIT01                         | P1_FCV03Z                        | P1_FT01Z                                     |                   |               |                               | P2_VYT02                |
|             | P1_FT01                           | P4_ST_TT01                       | P1_FT03                          | P1_FT03                                      |                   |               |                               | P2_VYT03                |
|             | P1_FT01Z                          |                                  | P1_FT03Z                         | P1_FT03Z                                     |                   |               |                               |                         |
|             | P1_FT03                           |                                  |                                  | P1_LCV01D                                    |                   |               |                               |                         |
|             | P1_FT03Z                          |                                  |                                  | P1_LCV01Z                                    |                   |               |                               |                         |
|             | P1_LCV01D                         |                                  |                                  |                                              |                   |               |                               |                         |
|             | P1_LCV01Z                         |                                  |                                  |                                              |                   |               |                               |                         |

특히, 공격이 발생하지 않은 상황과 발생한 상황에서 변화하는 컬럼들의 상관관계에 집중하였습니다. 이러한 변화하는 컬럼들을 파악함으로써, StackedGRU 모델이 감지하지 못한 공격 지점을 식별할 수 있는 기반을 마련했습니다.

기존의 모델보다는 다른 성향의 모델을 앙상블 했을때 더 효과적이라고 생각하여 conv1d LSTM을 사용하였습니다. conv1d LSTM은 시계열 데이터의 시공간적 특성을 효과적으로 포착하는 능력이 있어, 본 연구의 목적에 적합했습니다.

모델의 파라미터 조정에 있어서는 'tap' 값에 주목하여, 최대한 정확한 예측 결과를 얻을 수 있도록 세심한 조정을 진행했습니다. 이는 나중에 OR 연산을 통한 앙상블 과정에서 모델의 성능을 최적화하기 위함이었습니다.

결과적으로 f1, f2, f4, f9, f11 이렇게 5개의 공격지점을 더 찾을 수 있었는데, 이중 f9와 f11을 앙상블 했을 때 성능이 가장 좋았습니다.

### 3) 최종 답안 (예측 성능 : 약 0.76)
아래와 같이 앙상블 하였습니다.
"stackedGRU758"+("f9-find6053"+"f11-find6031")="Answer.csv"

![Frame 1](https://github.com/S-SIRIUS/HAI-Anomaly-Detection/assets/109223193/ce33a2c3-6528-4436-9ff3-e92543b0eb66)


